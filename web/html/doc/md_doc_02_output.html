<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenPose: OpenPose Doc - Output</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_doxygen_black.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenPose
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
   <div id="projectbrief">The first real-time multi-person system to jointly detect human body, hand, facial, and foot keypoints</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_doc_02_output.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">OpenPose Doc - Output </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md33"></a>
Contents</h1>
<ol type="1">
<li><a href="#ui-and-visual-output">UI and Visual Output</a></li>
<li><a href="#json-ui-mapping">JSON-UI Mapping</a><ol type="a">
<li><a href="#pose-output-format-body_25">Pose Output Format (BODY_25)</a></li>
<li><a href="#pose-output-format-coco">Pose Output Format (COCO)</a></li>
<li><a href="#face-output-format">Face Output Format</a></li>
<li><a href="#hand-output-format">Hand Output Format</a></li>
</ol>
</li>
<li><a href="#output-format">JSON Output Format</a></li>
<li><a href="#body-keypoints-in-c-python">Keypoints in C++/Python</a><ol type="a">
<li><a href="#body-keypoint-ordering-in-c-python">Keypoint Ordering in C++/Python</a></li>
<li><a href="#keypoint-format-in-datum-advanced">Keypoint Format in Datum (Advanced)</a></li>
</ol>
</li>
<li><a href="#reading-saved-results">Reading Saved Results</a></li>
<li><a href="#advanced">Advanced</a><ol type="a">
<li><a href="#camera-matrix-output-format">Camera Matrix Output Format</a></li>
<li><a href="#heatmaps">Heatmaps</a></li>
</ol>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md34"></a>
UI and Visual Output</h1>
<p>The visual GUI should show the original image with the poses blended on it, similarly to the pose of this gif:</p>
<p><img src="../.github/media/shake.gif" alt="" width="720" class="inline"/> </p>
<h1><a class="anchor" id="autotoc_md35"></a>
JSON-UI Mapping</h1>
<p>The output of the JSON files consist of a set of keypoints, whose ordering is related with the UI output as follows:</p>
<h2><a class="anchor" id="autotoc_md36"></a>
Pose Output Format (BODY_25)</h2>
<p><img src="../.github/media/keypoints_pose_25.png" alt="" width="480" class="inline"/> </p>
<h2><a class="anchor" id="autotoc_md37"></a>
Pose Output Format (COCO)</h2>
<p><img src="../.github/media/keypoints_pose_18.png" alt="" width="480" class="inline"/> </p>
<h2><a class="anchor" id="autotoc_md38"></a>
Face Output Format</h2>
<p><img src="../.github/media/keypoints_face.png" alt="" width="480" class="inline"/> </p>
<h2><a class="anchor" id="autotoc_md39"></a>
Hand Output Format</h2>
<p><img src="../.github/media/keypoints_hand.png" alt="" width="480" class="inline"/> </p>
<h1><a class="anchor" id="autotoc_md40"></a>
JSON Output Format</h1>
<p>There are 2 alternatives to save the OpenPose output. But both of them follow the keypoint ordering described in the section <a href="#body-keypoints-in-c-python">Keypoint Ordering in C++/Python</a> section (which you should read next).</p>
<ol type="1">
<li>The <code>--write_json</code> flag saves the people pose data into JSON files. Each file represents a frame, it has a <code>people</code> array of objects, where each object has:<ol type="a">
<li><code>pose_keypoints_2d</code>: Body part locations (<code>x</code>, <code>y</code>) and detection confidence (<code>c</code>) formatted as <code>x0,y0,c0,x1,y1,c1,...</code>. The coordinates <code>x</code> and <code>y</code> can be normalized to the range [0,1], [-1,1], [0, source size], [0, output size], etc. (see the flag <code>--keypoint_scale</code> for more information), while the confidence score (<code>c</code>) in the range [0,1]. Additionally, the number of keypoints output in this array will remain consistent between JSON files.</li>
<li><code>face_keypoints_2d</code>, <code>hand_left_keypoints_2d</code>, and <code>hand_right_keypoints_2d</code> are analogous to <code>pose_keypoints_2d</code> but applied to the face and hand parts.</li>
<li><code>body_keypoints_3d</code>, <code>face_keypoints_3d</code>, <code>hand_left_keypoints_2d</code>, and <code>hand_right_keypoints_2d</code> are analogous but applied to the 3-D parts. They are empty if <code>--3d</code> is not enabled. Their format is <code>x0,y0,z0,c0,x1,y1,z1,c1,...</code>, where <code>c</code> is 1 or 0 depending on whether the 3-D reconstruction was successful or not.</li>
<li><code>part_candidates</code> (optional and advanced): The body part candidates before being assembled into people. Empty if <code>--part_candidates</code> is not enabled (see that flag for more details). <div class="fragment"><div class="line">{</div>
<div class="line">    &quot;version&quot;:1.1,</div>
<div class="line">    &quot;people&quot;:[</div>
<div class="line">        {</div>
<div class="line">            &quot;pose_keypoints_2d&quot;:[582.349,507.866,0.845918,746.975,631.307,0.587007,...],</div>
<div class="line">            &quot;face_keypoints_2d&quot;:[468.725,715.636,0.189116,554.963,652.863,0.665039,...],</div>
<div class="line">            &quot;hand_left_keypoints_2d&quot;:[746.975,631.307,0.587007,615.659,617.567,0.377899,...],</div>
<div class="line">            &quot;hand_right_keypoints_2d&quot;:[617.581,472.65,0.797508,0,0,0,723.431,462.783,0.88765,...]</div>
<div class="line">            &quot;pose_keypoints_3d&quot;:[582.349,507.866,507.866,0.845918,507.866,746.975,631.307,0.587007,...],</div>
<div class="line">            &quot;face_keypoints_3d&quot;:[468.725,715.636,715.636,0.189116,715.636,554.963,652.863,0.665039,...],</div>
<div class="line">            &quot;hand_left_keypoints_3d&quot;:[746.975,631.307,631.307,0.587007,631.307,615.659,617.567,0.377899,...],</div>
<div class="line">            &quot;hand_right_keypoints_3d&quot;:[617.581,472.65,472.65,0.797508,472.65,0,0,0,723.431,462.783,0.88765,...]</div>
<div class="line">        }</div>
<div class="line">    ],</div>
<div class="line">    // If `--part_candidates` enabled</div>
<div class="line">    &quot;part_candidates&quot;:[</div>
<div class="line">        {</div>
<div class="line">            &quot;0&quot;:[296.994,258.976,0.845918,238.996,365.027,0.189116],</div>
<div class="line">            &quot;1&quot;:[381.024,321.984,0.587007],</div>
<div class="line">            &quot;2&quot;:[313.996,314.97,0.377899],</div>
<div class="line">            &quot;3&quot;:[238.996,365.027,0.189116],</div>
<div class="line">            &quot;4&quot;:[283.015,332.986,0.665039],</div>
<div class="line">            &quot;5&quot;:[457.987,324.003,0.430488,283.015,332.986,0.665039],</div>
<div class="line">            &quot;6&quot;:[],</div>
<div class="line">            &quot;7&quot;:[],</div>
<div class="line">            &quot;8&quot;:[],</div>
<div class="line">            &quot;9&quot;:[],</div>
<div class="line">            &quot;10&quot;:[],</div>
<div class="line">            &quot;11&quot;:[],</div>
<div class="line">            &quot;12&quot;:[],</div>
<div class="line">            &quot;13&quot;:[],</div>
<div class="line">            &quot;14&quot;:[293.001,242.991,0.674305],</div>
<div class="line">            &quot;15&quot;:[314.978,241,0.797508],</div>
<div class="line">            &quot;16&quot;:[],</div>
<div class="line">            &quot;17&quot;:[369.007,235.964,0.88765]</div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ol>
</li>
<li>(Deprecated) <code>--write_keypoint</code> uses the OpenCV <code>cv::FileStorage</code> default formats, i.e., JSON (if OpenCV 3 or higher), XML, and YML. It only prints 2D body information (no 3D or face/hands).</li>
</ol>
<p>(Low level details) If you wanted to change anything in this file format (e.g., the output file name), you could check and/or modify <a href="../src/openpose/filestream/peopleJsonSaver.cpp">peopleJsonSaver.cpp</a>.</p>
<h1><a class="anchor" id="autotoc_md41"></a>
Keypoints in C++/Python</h1>
<h2><a class="anchor" id="autotoc_md42"></a>
Keypoint Ordering in C++/Python</h2>
<p>The body part mapping order of any body model (e.g., <code>BODY_25</code>, <code>COCO</code>, <code>MPI</code>) can be extracted from the C++ and Python APIs.</p>
<ul>
<li>In C++, <code>getPoseBodyPartMapping(const PoseModel poseModel)</code> is available in <a href="../include/openpose/pose/poseParameters.hpp">poseParameters.hpp</a>: <div class="fragment"><div class="line">// C++ API call</div>
<div class="line">#include &lt;openpose/pose/poseParameters.hpp&gt;</div>
<div class="line">const auto&amp; poseBodyPartMappingBody25 = getPoseBodyPartMapping(PoseModel::BODY_25);</div>
<div class="line">const auto&amp; poseBodyPartMappingCoco = getPoseBodyPartMapping(PoseModel::COCO_18);</div>
<div class="line">const auto&amp; poseBodyPartMappingMpi = getPoseBodyPartMapping(PoseModel::MPI_15);</div>
<div class="line">const auto&amp; poseBodyPartMappingBody25B = getPoseBodyPartMapping(PoseModel::BODY_25B);</div>
<div class="line">const auto&amp; poseBodyPartMappingBody135 = getPoseBodyPartMapping(PoseModel::BODY_135);</div>
<div class="line"> </div>
<div class="line">// Result for BODY_25 (25 body parts consisting of COCO + foot)</div>
<div class="line">// const std::map&lt;unsigned int, std::string&gt; POSE_BODY_25_BODY_PARTS {</div>
<div class="line">//     {0,  &quot;Nose&quot;},</div>
<div class="line">//     {1,  &quot;Neck&quot;},</div>
<div class="line">//     {2,  &quot;RShoulder&quot;},</div>
<div class="line">//     {3,  &quot;RElbow&quot;},</div>
<div class="line">//     {4,  &quot;RWrist&quot;},</div>
<div class="line">//     {5,  &quot;LShoulder&quot;},</div>
<div class="line">//     {6,  &quot;LElbow&quot;},</div>
<div class="line">//     {7,  &quot;LWrist&quot;},</div>
<div class="line">//     {8,  &quot;MidHip&quot;},</div>
<div class="line">//     {9,  &quot;RHip&quot;},</div>
<div class="line">//     {10, &quot;RKnee&quot;},</div>
<div class="line">//     {11, &quot;RAnkle&quot;},</div>
<div class="line">//     {12, &quot;LHip&quot;},</div>
<div class="line">//     {13, &quot;LKnee&quot;},</div>
<div class="line">//     {14, &quot;LAnkle&quot;},</div>
<div class="line">//     {15, &quot;REye&quot;},</div>
<div class="line">//     {16, &quot;LEye&quot;},</div>
<div class="line">//     {17, &quot;REar&quot;},</div>
<div class="line">//     {18, &quot;LEar&quot;},</div>
<div class="line">//     {19, &quot;LBigToe&quot;},</div>
<div class="line">//     {20, &quot;LSmallToe&quot;},</div>
<div class="line">//     {21, &quot;LHeel&quot;},</div>
<div class="line">//     {22, &quot;RBigToe&quot;},</div>
<div class="line">//     {23, &quot;RSmallToe&quot;},</div>
<div class="line">//     {24, &quot;RHeel&quot;},</div>
<div class="line">//     {25, &quot;Background&quot;}</div>
<div class="line">// };</div>
</div><!-- fragment --></li>
<li>You can also check them on Python: <div class="fragment"><div class="line">poseModel = op.PoseModel.BODY_25</div>
<div class="line">print(op.getPoseBodyPartMapping(poseModel))</div>
<div class="line">print(op.getPoseNumberBodyParts(poseModel))</div>
<div class="line">print(op.getPosePartPairs(poseModel))</div>
<div class="line">print(op.getPoseMapIndex(poseModel))</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="autotoc_md43"></a>
Keypoint Format in Datum (Advanced)</h2>
<p>This section is only for advance users that plan to use the C++ API. Not needed for the OpenPose demo and/or Python API.</p>
<p>There are 3 different keypoint <code>Array&lt;float&gt;</code> elements in the <code>Datum</code> class:</p>
<ol type="1">
<li><a class="el" href="classop_1_1_array.html">Array&lt;float&gt;</a> <b>poseKeypoints</b>: In order to access person <code>person</code> and body part <code>part</code> (where the index matches <code>POSE_COCO_BODY_PARTS</code> or <code>POSE_MPI_BODY_PARTS</code>), you can simply output: <div class="fragment"><div class="line">// Common parameters needed</div>
<div class="line">const auto numberPeopleDetected = poseKeypoints.getSize(0);</div>
<div class="line">const auto numberBodyParts = poseKeypoints.getSize(1);</div>
<div class="line">// Easy version</div>
<div class="line">const auto x = poseKeypoints[{person, part, 0}];</div>
<div class="line">const auto y = poseKeypoints[{person, part, 1}];</div>
<div class="line">const auto score = poseKeypoints[{person, part, 2}];</div>
<div class="line">// Slightly more efficient version</div>
<div class="line">// If you want to access these elements on a huge loop, you can get the index</div>
<div class="line">// by your own, but it is usually not faster enough to be worthy</div>
<div class="line">const auto baseIndex = poseKeypoints.getSize(2)*(person*numberBodyParts + part);</div>
<div class="line">const auto x = poseKeypoints[baseIndex];</div>
<div class="line">const auto y = poseKeypoints[baseIndex + 1];</div>
<div class="line">const auto score = poseKeypoints[baseIndex + 2];</div>
</div><!-- fragment --></li>
<li><a class="el" href="classop_1_1_array.html">Array&lt;float&gt;</a> <b>faceKeypoints</b>: It is completely analogous to poseKeypoints. <div class="fragment"><div class="line">// Common parameters needed</div>
<div class="line">const auto numberPeopleDetected = faceKeypoints.getSize(0);</div>
<div class="line">const auto numberFaceParts = faceKeypoints.getSize(1);</div>
<div class="line">// Easy version</div>
<div class="line">const auto x = faceKeypoints[{person, part, 0}];</div>
<div class="line">const auto y = faceKeypoints[{person, part, 1}];</div>
<div class="line">const auto score = faceKeypoints[{person, part, 2}];</div>
<div class="line">// Slightly more efficient version</div>
<div class="line">const auto baseIndex = faceKeypoints.getSize(2)*(person*numberFaceParts + part);</div>
<div class="line">const auto x = faceKeypoints[baseIndex];</div>
<div class="line">const auto y = faceKeypoints[baseIndex + 1];</div>
<div class="line">const auto score = faceKeypoints[baseIndex + 2];</div>
</div><!-- fragment --></li>
<li>std::array&lt;<a class="el" href="classop_1_1_array.html">Array&lt;float&gt;</a>, 2&gt; <b>handKeypoints</b>, where handKeypoints[0] corresponds to the left hand and handKeypoints[1] to the right one. Each handKeypoints[i] is analogous to poseKeypoints and faceKeypoints: <div class="fragment"><div class="line">// Common parameters needed</div>
<div class="line">const auto numberPeopleDetected = handKeypoints[0].getSize(0); // = handKeypoints[1].getSize(0)</div>
<div class="line">const auto numberHandParts = handKeypoints[0].getSize(1); // = handKeypoints[1].getSize(1)</div>
<div class="line"> </div>
<div class="line">// Easy version</div>
<div class="line">// Left Hand</div>
<div class="line">const auto xL = handKeypoints[0][{person, part, 0}];</div>
<div class="line">const auto yL = handKeypoints[0][{person, part, 1}];</div>
<div class="line">const auto scoreL = handKeypoints[0][{person, part, 2}];</div>
<div class="line">// Right Hand</div>
<div class="line">const auto xR = handKeypoints[1][{person, part, 0}];</div>
<div class="line">const auto yR = handKeypoints[1][{person, part, 1}];</div>
<div class="line">const auto scoreR = handKeypoints[1][{person, part, 2}];</div>
<div class="line"> </div>
<div class="line">// Slightly more efficient version</div>
<div class="line">const auto baseIndex = handKeypoints[0].getSize(2)*(person*numberHandParts + part);</div>
<div class="line">// Left Hand</div>
<div class="line">const auto xL = handKeypoints[0][baseIndex];</div>
<div class="line">const auto yL = handKeypoints[0][baseIndex + 1];</div>
<div class="line">const auto scoreL = handKeypoints[0][baseIndex + 2];</div>
<div class="line">// Right Hand</div>
<div class="line">const auto xR = handKeypoints[1][baseIndex];</div>
<div class="line">const auto yR = handKeypoints[1][baseIndex + 1];</div>
<div class="line">const auto scoreR = handKeypoints[1][baseIndex + 2];</div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="autotoc_md44"></a>
Reading Saved Results</h1>
<p>We use the standard formats (JSON, PNG, JPG, ...) to save our results, so there are many open-source libraries to read them in most programming languages (especially Python). For C++, you might want to check <a href="../include/openpose/filestream/fileStream.hpp">include/openpose/filestream/fileStream.hpp</a>. In particular, <code>loadData</code> (for JSON, XML and YML files) and <code>loadImage</code> (for image formats such as PNG or JPG) to load the data into cv::Mat format.</p>
<h1><a class="anchor" id="autotoc_md45"></a>
Advanced</h1>
<h2><a class="anchor" id="autotoc_md46"></a>
Camera Matrix Output Format</h2>
<p>If you need to use the camera calibration or 3D modules, the camera matrix output format is detailed in <a href="advanced/calibration_module.md#camera-matrix-output-format">doc/advanced/calibration_module.md#camera-matrix-output-format</a>.</p>
<h2><a class="anchor" id="autotoc_md47"></a>
Heatmaps</h2>
<p>If you need to use heatmaps, check <a class="el" href="md_doc_advanced_heatmap_output.html">doc/advanced/heatmap_output.md</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
