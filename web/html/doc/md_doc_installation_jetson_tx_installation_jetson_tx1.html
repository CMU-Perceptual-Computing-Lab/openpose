<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenPose: OpenPose Doc - Installation on Nvidia Jetson TX1</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_doxygen_black.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenPose
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
   <div id="projectbrief">The first real-time multi-person system to jointly detect human body, hand, facial, and foot keypoints</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_doc_installation_jetson_tx_installation_jetson_tx1.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">OpenPose Doc - Installation on Nvidia Jetson TX1 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md239"></a>
Introduction</h1>
<p>We do not officially support TX1, but thanks to @dreinsdo, we have these instructions about how he made it work in his TX1. We would like to thank @dreinsdo, who added this documentation in <a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose/issues/1124#issuecomment-474090671">this GitHub issue post</a>. If you face any issue, feel free to post on that issue post.</p>
<h1><a class="anchor" id="autotoc_md240"></a>
Purpose</h1>
<p>This document describes the full procedure for installing openpose on the Jetson TX1. Other, and less involved, procedures may have been found successful by community members, and we encourage you to share your alternatives.</p>
<h1><a class="anchor" id="autotoc_md241"></a>
Preliminary remarks</h1>
<p>This procedure details moving the Jetson file system to a larger drive, building a custom kernel, building OpenCV from source, and customizing Openpose Makefiles because TX1 eMMC is limited, the onboard camera did not work with Openpose, stock Jetpack 3.1 OpenCV build lacks Openpose dependencies, and Openpose makefiles are not compatible with TX1 CUDA arch, respectively. We used a PS3 Eye camera in place of the onboard camera, and a 120Gb SSD, but most USB webcams and SATA drives should work fine.</p>
<h1><a class="anchor" id="autotoc_md242"></a>
Contents</h1>
<ul>
<li><a href="#prep-the-tx1">Prep the TX1</a></li>
<li><a href="#build-custom-kernel">Build custom kernel</a></li>
<li><a href="#build-opencv-from-source">Build OpenCV from source</a></li>
<li><a href="#install-openpose">Install Openpose</a></li>
<li><a href="#usage">Usage</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md243"></a>
Prep the TX1</h1>
<ol type="1">
<li>Flash Jetson TX1 with <a href="https://developer.nvidia.com/embedded/jetpack">JetPack 3.1</a> per Jetpack installation guide. Be sure to complete both OS flashing and CUDA&#160;/ cuDNN installation parts before installation.</li>
<li>Move file system to SATA drive. Follow steps of JetsonHacks article <a href="https://www.jetsonhacks.com/2017/01/28/install-samsung-ssd-on-nvidia-jetson-tx1/">Install Samsung SSD on NVIDIA Jetson TX1</a>.</li>
</ol>
<h1><a class="anchor" id="autotoc_md244"></a>
Build custom kernel</h1>
<p>This step is required because we were not able to use Openpose with the onboard TX1 camera. The steps are a combination of two JetsonHacks articles <a href="https://www.jetsonhacks.com/2017/08/07/build-kernel-ttyacm-module-nvidia-jetson-tx1/">Build Kernel and ttyACM Module – NVIDIA Jetson TX1</a> and <a href="https://www.jetsonhacks.com/2016/09/29/sony-playstation-eye-nvidia-jetson-tx1/">Sony PlayStation Eye – NVIDIA Jetson TX1</a>. If you are using a different webcam then include the driver for that webcam in place of the PS3 eye driver in step 3.</p><ol type="1">
<li>Get the install scripts from <a href="https://github.com/jetsonhacks/buildJetsonTX1Kernel/archive/v1.0-L4T28.1.zip">JetsonHacks Github</a>. This link is to the zip of the 'JetPack 3.1' release. If you $git clone$ from the master branch then you will get the most recent kernel build files, which are not compatible with JetPack 3.1.</li>
<li>Unzip the downloaded files, enter the unzipped directory and run script to get kernel sources. <div class="fragment"><div class="line">$ cd buildJetsonTX1Kernel</div>
<div class="line">$ sudo ./getKernelSources.sh</div>
</div><!-- fragment --></li>
<li>The script will open the editor for the kernel configuration. Find the driver for your webcam and select with a checkbox (not a dot). Save the configuration and quit the config window.</li>
<li>Make the kernel. <div class="fragment"><div class="line">$ sudo ./makeKernel.sh</div>
</div><!-- fragment --></li>
<li>Replace the current kernel the newly built kernel image. <div class="fragment"><div class="line">$ sudo cp /usr/src/kernel/kernel-4.4/arch/arm64/boot/Image ($PATH_TO_EMMC)/boot/Image</div>
</div><!-- fragment --> Replace $PATH_TO_EMMC with the path to your eMMC. This is required because the Jetson initially boots to eMMC and loads the kernel from their, even with the SATA drive connected.</li>
</ol>
<h1><a class="anchor" id="autotoc_md245"></a>
Build OpenCV from source</h1>
<p>Follow JK Jung's steps from <a href="https://jkjung-avt.github.io/opencv3-on-tx2/">How to Install OpenCV (3.4.0) on Jetson TX2</a> verbatim, with the following exception: omit installation of Python3 dependencies, i.e. skip the following lines. </p><div class="fragment"><div class="line">$ sudo apt-get install python3-dev python3-pip python3-tk</div>
<div class="line">$ sudo pip3 install numpy</div>
<div class="line">$ sudo pip3 install matplotlib</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md246"></a>
Install Openpose</h1>
<p>The following steps detail the modification of three files to install Openpose. Modified versions of the files are attached and may alternatively be used. To use, be sure to rename both makefile configs to <code>Makefile.config.Ubuntu16_cuda8_JetsonTX2</code>.</p><ol type="1">
<li>Clone from the master branch. <div class="fragment"><div class="line">$ git clone https://github.com/CMU-Perceptual-Computing-Lab/openpose</div>
<div class="line">$ cd openpose</div>
</div><!-- fragment --></li>
<li>Modify makefile config. For the installation procedure we will use the TX2 files for JetPack 3.1. <div class="fragment"><div class="line">$ gedit scripts/ubuntu/Makefile.config.Ubuntu16_cuda8_JetsonTX2</div>
</div><!-- fragment --> Uncomment the opencv line <div class="fragment"><div class="line">OPENCV_VERSION := 3</div>
</div><!-- fragment --> Replace all the 'CUDA_ARCH :=' lines with the following <div class="fragment"><div class="line">CUDA_ARCH := -gencode arch=compute_53,code=[sm_53,compute_53]</div>
</div><!-- fragment --> Add CUDNN - not sure if this is necessary, have not retried the install without it. <div class="fragment"><div class="line">USE_CUDNN := 1</div>
</div><!-- fragment --></li>
<li>Correct error in install script path. <div class="fragment"><div class="line">$ gedit scripts/ubuntu/install_caffe_and_openpose_JetsonTX2_JetPack3.1.sh</div>
</div><!-- fragment --> Replace <div class="fragment"><div class="line">executeShInItsFolder &quot;install_openpose_JetsonTX2_JetPack3.1.sh&quot; &quot;./scripts/ubuntu/&quot; &quot;./&quot;</div>
</div><!-- fragment --> with <div class="fragment"><div class="line">executeShInItsFolder &quot;./scripts/ubuntu/install_openpose_JetsonTX2_JetPack3.1.sh&quot; &quot;./&quot; &quot;./&quot;</div>
</div><!-- fragment --></li>
<li>Start the install process. When you initially call the install script the caffe repo will be cloned and associated files downloaded. As soon as Caffe starts compiling, halt the process and change the makefile config as in step 2. <div class="fragment"><div class="line">bash ./scripts/ubuntu/install_caffe_and_openpose_JetsonTX2_JetPack3.1.sh</div>
</div><!-- fragment --> Once caffe begins to compile <code>CTRL+C</code>. <div class="fragment"><div class="line">$ gedit 3rdparty/caffe/Makefile.config.Ubuntu16_cuda8_JetsonTX2</div>
</div><!-- fragment --> Make the same changes as in step 2. The CUDNN switch should already be on.</li>
<li>Restart the installation process. <div class="fragment"><div class="line">bash ./scripts/ubuntu/install_caffe_and_openpose_JetsonTX2_JetPack3.1.sh</div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="autotoc_md247"></a>
Usage</h1>
<p>To get to decent FPS you need to lower the net resolution: </p><div class="fragment"><div class="line">./build/examples/openpose/openpose.bin -camera_resolution 640x480 -net_resolution 128x96</div>
</div><!-- fragment --><p>To activate hand or face resolution please complete this command with the following options (warning, both simultaneously will cause out of memory error): </p><div class="fragment"><div class="line"># Body and face</div>
<div class="line">./build/examples/openpose/openpose.bin --face -face_net_resolution 256x256</div>
<div class="line"># Body and hands</div>
<div class="line">./build/examples/openpose/openpose.bin --hand -hand_net_resolution 256x256</div>
<div class="line"># All body, face, and hands</div>
<div class="line">./build/examples/openpose/openpose.bin --face -face_net_resolution 256x256 --hand -hand_net_resolution 256x256</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
