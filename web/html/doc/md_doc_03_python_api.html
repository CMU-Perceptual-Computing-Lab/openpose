<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenPose: OpenPose Doc - Python API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_doxygen_black.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenPose
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
   <div id="projectbrief">The first real-time multi-person system to jointly detect human body, hand, facial, and foot keypoints</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_doc_03_python_api.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">OpenPose Doc - Python API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md48"></a>
Contents</h1>
<ol type="1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#advance-introduction-optional">Advance Introduction (Optional)</a></li>
<li><a href="#compatibility">Compatibility</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#testing-and-developing">Testing And Developing</a></li>
<li><a href="#exporting-python-openpose">Exporting Python OpenPose</a></li>
<li><a href="#common-issues">Common Issues</a></li>
</ol>
<h1><a class="anchor" id="autotoc_md49"></a>
Introduction</h1>
<p>Almost all the OpenPose functionality, but in Python!</p>
<p>When should you look at the <a class="el" href="md_doc_03_python_api.html">Python</a> or <a class="el" href="md_doc_04_cpp_api.html">C++</a> APIs? If you want to read a specific input, and/or add your custom post-processing function, and/or implement your own display/saving.</p>
<p>You should be familiar with the <a class="el" href="md_doc_01_demo.html">**OpenPose Demo**</a> and the main OpenPose flags before trying to read the C++ or Python API examples. Otherwise, it will be way harder to follow.</p>
<h1><a class="anchor" id="autotoc_md50"></a>
Advance Introduction (Optional)</h1>
<p>This module exposes a Python API for OpenPose. It is effectively a wrapper that replicates most of the functionality of the <a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose/blob/master/include/openpose/wrapper/wrapper.hpp">op::Wrapper class</a> and allows you to populate and retrieve data from the <a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose/blob/master/include/openpose/core/datum.hpp">op::Datum class</a> using standard Python and Numpy constructs.</p>
<p>The Python API is analogous to the C++ function calls. You may find them in <a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose/blob/master/python/openpose/openpose_python.cpp#L194">python/openpose/openpose_python.cpp#L194</a>.</p>
<p>The Python API is rather simple: <code><a class="el" href="classop_1_1_array.html">op::Array</a>&lt;float&gt;</code> and <code>cv::Mat</code> objects get casted to numpy arrays automatically. Every other data structure based on the standard library is automatically converted into Python objects. For example, an <code>std::vector&lt;std::vector&lt;float&gt;&gt;</code> would become <code>[[item, item], [item, item]]</code>, etc. We also provide a casting of <code><a class="el" href="structop_1_1_rectangle.html">op::Rectangle</a></code> and <code><a class="el" href="structop_1_1_point.html">op::Point</a></code> which simply expose setter getter for [x, y, width, height], etc.</p>
<h1><a class="anchor" id="autotoc_md51"></a>
Compatibility</h1>
<p>The OpenPose Python module is compatible with both Python 2 and Python 3 (default and recommended). In addition, it will also run in all OpenPose compatible operating systems. It uses <a href="https://github.com/pybind/pybind11">Pybind11</a> for mapping between C++ and Python datatypes.</p>
<p>To compile, enable <code>BUILD_PYTHON</code> in CMake-gui, or run <code>cmake -DBUILD_PYTHON=ON ..</code> from your build directory. In Windows, make sure you compile the whole solution (clicking the green play button does not compile the whole solution!). You can do that by right-click on the OpenPose project solution, and clicking in <code>Build Solution</code> (or individually building the PyOpenPose module).</p>
<p>Pybind selects the latest version of Python by default (Python 3). To use Python 2, change <code>PYTHON_EXECUTABLE</code> and <code>PYTHON_LIBRARY</code> flags in CMake-gui to your desired Python version.</p>
<div class="fragment"><div class="line"># Ubuntu</div>
<div class="line">PYTHON_EXECUTABLE=/usr/bin/python2.7</div>
<div class="line">PYTHON_LIBRARY=/usr/lib/x86_64-linux-gnu/libpython2.7m.so</div>
</div><!-- fragment --><div class="fragment"><div class="line"># Mac OSX</div>
<div class="line">PYTHON_EXECUTABLE=/usr/local/bin/python2.7</div>
<div class="line">PYTHON_LIBRARY=/usr/local/opt/python/Frameworks/Python.framework/Versions/2.7/lib/libpython2.7m.dylib</div>
</div><!-- fragment --><div class="fragment"><div class="line">:: Windows</div>
<div class="line">PYTHON_EXECUTABLE=C:/Users/user/AppData/Local/Programs/Python/Python27/python.exe</div>
</div><!-- fragment --><p>If run via the command line, you may need to run cmake twice in order for this change to take effect.</p>
<h1><a class="anchor" id="autotoc_md52"></a>
Installation</h1>
<p>Make sure you followed the Python steps in <a href="installation/0_index.md#cmake-configuration">doc/installation/0_index.md#cmake-configuration</a>.</p>
<h1><a class="anchor" id="autotoc_md53"></a>
Testing And Developing</h1>
<p>All the Python examples from the Tutorial API Python module can be found in <code>build/examples/tutorial_api_python</code> in your build folder. Navigate directly to this path to run examples.</p>
<div class="fragment"><div class="line"># From command line</div>
<div class="line">cd build/examples/tutorial_api_python</div>
<div class="line"> </div>
<div class="line"># Python 3 (default version)</div>
<div class="line">python3 01_body_from_image.py</div>
<div class="line">python3 02_whole_body_from_image.py</div>
<div class="line"># python3 [any_other_python_example.py]</div>
<div class="line"> </div>
<div class="line"># Python 2</div>
<div class="line">python2 01_body_from_image.py</div>
<div class="line">python2 02_whole_body_from_image.py</div>
<div class="line"># python2 [any_other_python_example.py]</div>
</div><!-- fragment --><p>For quick prototyping, you can simply duplicate and rename any of the existing sample files in <code>build/examples/tutorial_api_python</code> within that same folder and start building in there. These files are copied from <a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose/tree/master/examples/tutorial_api_python">existing example files</a> on compiling time. 2 alternatives:</p><ul>
<li>You can either duplicate and create your files in <a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose/tree/master/examples/tutorial_api_python">examples/tutorial_api_python/</a>, but you will have to recompile OpenPose every time you make changes to your Python files so they are copied over the <code>build/</code> folder.</li>
<li>Or you can directly edit them in <code>build/examples/tutorial_api_python</code>. This does not require rebuilding, but cleaning OpenPose will remove the whole <code>build/</code> folder, so make sure to back your files up!</li>
</ul>
<h1><a class="anchor" id="autotoc_md54"></a>
Exporting Python OpenPose</h1>
<p>Note: This step is only required if you are moving the <code>*.py</code> files outside their original location, or writing new <code>*.py</code> scripts outside <code>build/examples/tutorial_api_python</code>.</p>
<p>Ubuntu/OSX:</p>
<ul>
<li>Option a, installing OpenPose: On an Ubuntu or OSX based system, you could install OpenPose by running <code>sudo make install</code>, you could then set the OpenPose path in your python scripts to the OpenPose installation path (default: <code>/usr/local/python</code>) and start using OpenPose at any location. Take a look at <code>build/examples/tutorial_api_python/01_body_from_image.py</code> for an example.</li>
<li>Option b, not installing OpenPose: To move the OpenPose Python API demos to a different folder, ensure that the line &lsquo;sys.path.append(&rsquo;{OpenPose_path}/python')<code>is properly set in your</code>*.py<code>files, where</code>{OpenPose_path}<code>points to your build folder of OpenPose. Take a look at</code>build/examples/tutorial_api_python/01_body_from_image.py` for an example.</li>
</ul>
<p>Windows:</p>
<ul>
<li>Ensure that the folder <code>build/x{86/64}/Release</code>and <code>build/bin</code> are copied along with <code>build/python</code> As noted in the example, the path for these can be changed in the following two variables:</li>
</ul>
<div class="fragment"><div class="line">sys.path.append(dir_path + &#39;/../../python/openpose/Release);</div>
<div class="line">os.environ[&#39;PATH&#39;]  = os.environ[&#39;PATH&#39;] + &#39;;&#39; + dir_path + &#39;/../../{x86/x64}/Release;&#39; +  dir_path + &#39;/../../bin;&#39;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md55"></a>
Common Issues</h1>
<h2><a class="anchor" id="autotoc_md56"></a>
Do not use PIL</h2>
<p>In order to read images in Python, make sure to use OpenCV (do not use PIL). We found that feeding a PIL image format to OpenPose results in the input image appearing in grey and duplicated 9 times (so the output skeleton appear 3 times smaller than they should be, and duplicated 9 times).</p>
<h2><a class="anchor" id="autotoc_md57"></a>
Cannot Import Name PyOpenPose</h2>
<p>The error in general is that PyOpenPose cannot be found (an error similar to: <code>ImportError: cannot import name pyopenpose</code>). Ensure first that <code>BUILD_PYTHON</code> flag is set to ON. If the error persists, check the following:</p>
<p>In the script you are running, check for the following line, and run the following command in the same location as where the file is</p>
<p><b>Ubuntu/OSX:</b></p>
<p>&lsquo;sys.path.append(&rsquo;../../python');`</p>
<div class="fragment"><div class="line">ls ../../python/openpose</div>
</div><!-- fragment --><p>Check the contents of this location. It should contain one of the following files:</p>
<div class="fragment"><div class="line">pyopenpose.cpython-35m-x86_64-linux-gnu.so</div>
<div class="line">pyopenpose.so</div>
</div><!-- fragment --><p>If you do not have any one of those, you may not have compiled openpose successfully, or you may be running the examples, not from the build folder but the source folder. If you have the first one, you have compiled PyOpenPose for Python 3, and have to run the scripts with <code>python3</code>, and vice versa for the 2nd one. Follow the testing examples above for exact commands.</p>
<p><b>Windows:</b></p>
<p>Problem 1: If you are in Windows, and you fail to install the required third party Python libraries, it might print an error similar to: <code>Exception: Error: OpenPose library could not be found. Did you enable BUILD_PYTHON in CMake and have this Python script in the right folder?</code>. From GitHub issue #941: </p><div class="fragment"><div class="line">I had a similar issue with Visual Studio (VS). I am pretty sure that the issue is that while you are compiling OpenPose in VS, it tries to import cv2 (python-opencv) and it fails. So make sure that if you open cmd.exe and run Python, you can actually import cv2 without errors. I could not, but I had cv2 installed in a IPython environment (Anaconda), so I activated that environment, and then ran (change this to adapt it to your VS version and location of OpenPose.sln):</div>
<div class="line"> </div>
<div class="line">C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\MSBuild.exe C:\path\to\OpenPose.sln</div>
</div><!-- fragment --><p>Problem 2: Python for Openpose needs to be compiled in Release mode for now. This can be done in <a href="https://cdn.stereolabs.com/docs/getting-started/images/release_mode.png">Visual Studio</a>. Once that is done check this line:</p>
<p>&lsquo;sys.path.append(dir_path + &rsquo;/../../python/openpose/Release');`</p>
<div class="fragment"><div class="line">dir ../../python/openpose/Release</div>
</div><!-- fragment --><p>Check the contents of this location. It should contain one of the following files:</p>
<div class="fragment"><div class="line">pyopenpose.cp36-win_amd64.pyd</div>
<div class="line">pyopenpose.pyd</div>
</div><!-- fragment --><p>If such a folder does not exist, you need to compile in Release mode as seen above. If you have the first one, you have compiled PyOpenPose for Python 3, and have to run the scripts with <code>python3</code>, and vice versa for the 2nd one. Follow the testing examples above for exact commands. If that still does not work, check this line:</p>
<p>&lsquo;os.environ['PATH&rsquo;] = os.environ['PATH'] + ';' + dir_path + '/../../x64/Release;' + dir_path + '/../../bin;'`</p>
<div class="fragment"><div class="line">dir ../../x64/Release</div>
<div class="line">dir ../../bin</div>
</div><!-- fragment --><p>Ensure that both of these paths exist, as PyOpenPose needs to reference those libraries. If they don't exist, change the path so that they point to the correct location in your build folder. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
